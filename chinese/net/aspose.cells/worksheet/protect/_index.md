---
title: Protect
second_title: Aspose.Cells for .NET API 参考
description: 保护工作表
type: docs
weight: 770
url: /zh/net/aspose.cells/worksheet/protect/
---
## Protect(ProtectionType) {#protect}

保护工作表。

```csharp
public void Protect(ProtectionType type)
```

| 范围 | 类型 | 描述 |
| --- | --- | --- |
| type | ProtectionType | 保护类型。 |

### 评论

此方法无需密码即可保护工作表。它可以保护所有版本的 Excel 文件中的工作表。

### 也可以看看

* enum [ProtectionType](../../protectiontype)
* class [Worksheet](../../worksheet)
* 命名空间 [Aspose.Cells](../../worksheet)
* 部件 [Aspose.Cells](../../../)

---

## Protect(ProtectionType, string, string) {#protect_1}

保护工作表。

```csharp
public void Protect(ProtectionType type, string password, string oldPassword)
```

| 范围 | 类型 | 描述 |
| --- | --- | --- |
| type | ProtectionType | 保护类型。 |
| password | String | 密码。 |
| oldPassword | String | 如果工作表已受密码保护，请提供旧密码。 否则，您可以为此参数设置空值或空字符串。 |

### 评论

此方法可以保护所有版本的 Excel 文件中的工作表。

### 例子

```csharp

[C#]

 //实例化一个工作簿对象
Workbook excel = new Workbook("template.xlsx");
 //访问Excel文件中的第一个工作表
Worksheet worksheet = excel.Worksheets[0];
 //用密码保护工作表
worksheet.Protect(ProtectionType.All, "aspose", null);
 //默认保存修改后的Excel文件（即Excel 20003） format
excel.Save("output.xls");
 //关闭文件流释放所有资源

[Visual Basic]

'Creating a file stream containing the Excel file to be opened
Dim fstream As FileStream = New FileStream("book1.xls", FileMode.Open)
'Instantiating a Workbook object and Opening the Excel file through the file stream
Dim excel As Workbook = New Workbook(fstream)
'Accessing the first worksheet in the Excel file
Dim worksheet As Worksheet = excel.Worksheets(0)
'Protecting the worksheet with a password
worksheet.Protect(ProtectionType.All, "aspose", DBNull.Value.ToString())
'Saving the modified Excel file in default (that is Excel 20003) format
excel.Save("output.xls")
'Closing the file stream to free all resources
fstream.Close()

```

### 也可以看看

* enum [ProtectionType](../../protectiontype)
* class [Worksheet](../../worksheet)
* 命名空间 [Aspose.Cells](../../worksheet)
* 部件 [Aspose.Cells](../../../)

<!-- DO NOT EDIT: generated by xmldocmd for Aspose.Cells.dll -->

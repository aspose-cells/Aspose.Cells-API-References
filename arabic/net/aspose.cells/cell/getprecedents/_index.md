---
title: GetPrecedents
second_title: Aspose.Cells لمرجع .NET API
description: الحصول على كافة المراجع التي تظهر في صيغة هذه الخلية.
type: docs
weight: 470
url: /ar/net/aspose.cells/cell/getprecedents/
---
## Cell.GetPrecedents method

الحصول على كافة المراجع التي تظهر في صيغة هذه الخلية.

```csharp
public ReferredAreaCollection GetPrecedents()
```

### قيمة الإرجاع

مجموعة من كافة المراجع التي تظهر في صيغة هذه الخلية.

### ملاحظات

تُرجع فارغة إذا لم تكن هذه خلية معادلة.سيتم إرجاع جميع المراجع التي تظهر في صيغة هذه الخلية بغض النظر عن الإشارة إليها أم لا أثناء الحساب. على سبيل المثال ، على الرغم من أن الخلية A2 في الصيغة "= IF (TRUE ، A1 ، A2)" لم يتم استخدامها أثناء الحساب ، لا تزال تؤخذ على أنها سوابق للصيغة. للحصول على تلك المراجع التي تؤثر على الحساب فقط ، يرجى استخدام[`GetPrecedentsInCalculation`](../getprecedentsincalculation).

### أمثلة

```csharp
[C#]

Workbook workbook = new Workbook();
Cells cells = workbook.Worksheets[0].Cells;
cells["A1"].Formula = "=B1+SUM(B1:B10)+[Book1.xls]Sheet1!A1";
ReferredAreaCollection areas = cells["A1"].GetPrecedents();
for (int i = 0; i < areas.Count; i++)
{
     ReferredArea area = areas[i];
     StringBuilder stringBuilder = new StringBuilder();
     if (area.IsExternalLink)
     {
         stringBuilder.Append("[");
         stringBuilder.Append(area.ExternalFileName);
         stringBuilder.Append("]");
     }
     stringBuilder.Append(area.SheetName);
     stringBuilder.Append("!");
     stringBuilder.Append(CellsHelper.CellIndexToName(area.StartRow, area.StartColumn));
     if (area.IsArea)
     {
         stringBuilder.Append(":");
         stringBuilder.Append(CellsHelper.CellIndexToName(area.EndRow, area.EndColumn));
     }
     Console.WriteLine(stringBuilder.ToString());
}

[Visual Basic]

Dim workbook As Workbook = New Workbook()
Dim cells As Cells = workbook.Worksheets(0).Cells
cells("A1").Formula = "= B1 + SUM(B1:B10) + [Book1.xls]Sheet1!A1"
Dim areas As ReferredAreaCollection = cells("A1").GetPrecedents()
For i As Integer = 0 To areas.Count - 1
    Dim area As ReferredArea = areas(i)
    Dim stringBuilder As StringBuilder = New StringBuilder()
    If (area.IsExternalLink) Then
        stringBuilder.Append("[")
        stringBuilder.Append(area.ExternalFileName)
       stringBuilder.Append("]")
    End If
    stringBuilder.Append(area.SheetName)
    stringBuilder.Append("!")
    stringBuilder.Append(CellsHelper.CellIndexToName(area.StartRow, area.StartColumn))
    If (area.IsArea) Then
        stringBuilder.Append(":")
        stringBuilder.Append(CellsHelper.CellIndexToName(area.EndRow, area.EndColumn))
    End If
    Console.WriteLine(stringBuilder.ToString())
Next
```

### أنظر أيضا

* class [ReferredAreaCollection](../../referredareacollection)
* class [Cell](../../cell)
* مساحة الاسم [Aspose.Cells](../../cell)
* المجسم [Aspose.Cells](../../../)

<!-- DO NOT EDIT: generated by xmldocmd for Aspose.Cells.dll -->
